<html>
	<head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- Bootstrap core CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

		<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
		<link href="ie10-viewport-bug-workaround.css" rel="stylesheet">

		<!-- Custom styles for this template -->
		<link href="scrolling-nav.css" rel="stylesheet">
		<link href="https://bootswatch.com/flatly/bootstrap.min.css" rel="stylesheet">

		<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
		  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
	</head>
	<body id="page-top" data-target=".navbar-fixed-top">
		<nav class="navbar navbar-inverse navbar-fixed-top top-nav-collapse">
		  <div class="container">
			<div class="navbar-header page-scroll">
			  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">Toggle navigation</span>
			  </button>
			  <a class="navbar-brand page-scroll" href="index.html">Quine8</a>
			</div>
		  </div>
		</nav>

		<section style="margin-top: 5em; max-width: 50em;">
		<h1>Sorting and Arrays with Quine8</h1>
		<p>To introduce a little more complexity and explore some of the cooler features of Q8, we are going
		to write a simple sort. Bubblesort! It may be slow, but it's easy to understand, and easy enough to implement.</p>
		<h3>Bubblesort</h3>
		<a href="https://en.wikipedia.org/wiki/Bubble_sort">
			<div class="img_container">
				<img style="width: 30%;" src="https://upload.wikimedia.org/wikipedia/commons/c/c8/Bubble-sort-example-300px.gif">
			</div>
		</a>
		<p>In bubblesort, each element is compared with its neighbor and swapped if necessary. Unfortunately, it can't always sort
		the whole array in one pass. It must keep running until all of the elements have slowly made their way to their correct
		positions. Worst-case, the elements are sorted, but in the opposite direction of the desired sort, it takes the length of the array, n, times the
		the number of passes necessary to fix it, in this case, equal to the length of the array, n. That leaves the runtime at
		a miserable worst-case of n<sup>2</sup>. With a larger array, this can get really ridiculous.</p>
		<pre><code class="language-none">Main Loop - With Swap: 36 tiles
Main Loop - Without Swap: 31 tiles
Main Loop - Average: 33.5 tiles
Restart Loop: 24 tiles
n, our array length for this example is 5

Main Loop gets called once per element, so n times per sort iteration
Restart Loop gets called once per array walk, so average of n/2 times

Main Loop average * n * Restart Loop * (n/2) = ~10,050 tiles
Main Loop worst-case * n * Restart Loop * n = ~21,600 tiles
Main Loop best-case * n * Restart Loop * 1 = ~3,720 tiles (Loop is already sorted)</code></pre>
		<p>Assuming each tile takes 1 second, best case runs in 1 hour, 2 minutes, and worst case runs in 6 hours.
		n<sup>2</sup> time is not ideal. Bubblesort is more useful as a teaching tool than as a sort to use
		for practical applications.</p>
		</section>
		<section>
		<div class="multi_code_container">
			<div class="c_and_img">
				<div>
					<h3>C-like Program</h3>
					<pre><code class="language-c; line-numbers">int len = 5;
int array[len] = {5, 4, 3, 2, 1};
bool swapped = true;

while (swapped) {
    swapped = false;
    for (int i = 0; i &lt; len - 1; i++) {
	    int j = i + 1;
        if (array[j] &gt; array[i]) {
            swap(array, i, j);
            swapped = true;
        }
    }
}</code></pre>
			</div>
			<div>
				<h3>Bytecode Program</h3>
				<a href="q8.html#1|A|1|b|1|E|1|C|1|s|1|g|1|X|2|B|1|s|1|I|1|B|1|s|1|A|1|X|1|A|1|G|1|l|4|A|1|H|1|D|1|G|1|B|1|z|1|/|1|G|1|i|13|A|1|B|1|w|1|A|1|W|1|w|1|A|1|c|1|E|1|C|1|w|1|g|1|W|1|x|1|B|1|r|1|I|1|J|2|A|1|X|1|D|1|G|1|l|41|A|1|B|1|s|1|B|1|g|1|c|1|E|1|B|1|Q|1|F|1|s|1|A|1|O|1|x|1|B|1|L|1|I|1|W|1|H|1|n|1|A|1|H|1|s|1|Q|1|i|1|y|1|A|1|b|1|E|1|C|1|s|1|h|1|I|1|T|1|B|1|b|1|E|1|G|1|s|1|h|1|p|1|Q|2|A|1|X|1|D|1|L|1|x|1|p|1|f|58|A|1|U|1|E|1|A|1|w|1|I|1|B|15|A|1|E|1|o|1|K|1|E|101|A|1|P|1|A|2|=|">
					<img style="width: 90%; margin-left: 1.5em;" src="bubble.gif">
				</a>
			</div>
		</div>
		<div>
			<h3>Assembly Program</h3>
<pre><code class="language-none; line-numbers">; INIT
; Copy the starting indices and array length for later
start:
LOAD A 177 ; index: i
LOAD B 178 ; index + 1: j
STORE A 193 ; use as initial i
STORE B 194 ; use as initial j
LOAD A 176 ; len - 1
STORE A 192 ; use as initial j
JMP main_loop ; goto main loop

; 16 - IS SORTED?
is_sorted:
LOAD A 195 ; check if the swapped bool changed
ISZERO A
JZ exit ; goto exit
JMP restart_loop ; goto restart loop

; 32 - RESTART LOOP
restart_loop:
LOAD A 192 ; grab len - 1
STORE A 176 ; use as new remaining distance
LOAD A 193 ; grab initial i
LOAD B 194 ; grab initial j
STORE A 177 ; use as new i
STORE B 178 ; use as new j
SET A 0 ; swapped = false
STORE A 195 ; use as new swapped
JMP main_loop ; goto main loop

; 80 - MAIN LOOP
main_loop:
LOAD A 176 ; grab remaining distance to end of list
ISZERO A ; Are we all the way through the list?
JZ is_sorted ; goto is sorted?
DEC A ; remaining distance--
STORE A 176 ; store new distance
LOADI A 177 ; load i
LOADI B 178 ; load j
CMP A B ; compare i and j
JG swap_val ; goto swap values if necessary

; 95 - STORE REGISTERS
store_reg:
STOREI A 177 ; store A at grid[i]
STOREI B 178 ; store B at grid[j]
LOAD A 177 ; load i
LOAD B 178 ; load j
INC A ; i++
INC B ; j++
STORE A 177 ; update i
STORE B 178 ; update j
JMP main_loop ; goto main loop

; 112 - SWAP VALUES
swap_val:
STORE A 195 ; swapped = true
SWAP A B
JMP store_reg ; goto store registers

; 255 - EXIT
exit:
HALT

; DATA
$160 5 4 3 2 1 ; ARRAY
$176 4 160 161 ; ARRAY LENGTH, idx, idx + 1
</code></pre>
			</div>
		</div>
		</section>
		<link rel="stylesheet" href="prism.css">
		<link href="tutorial_style.css" rel="stylesheet">
		<script src="prism.js"></script>
	</body>
	<footer style="margin-top: 4em; padding-bottom: 4em; background-color: #555"></footer>
</html>
